<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giỏ Hàng - NHN Sports</title>
    <link rel="stylesheet" href="chitietsanpham/css/style.css">
    <script src="https://kit.fontawesome.com/54f0cb7e4a.js" crossorigin="anonymous"></script>
    <style>
        body {
            font-family: "Segoe UI", sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
        }
        main {
            max-width: 1000px;
            margin: 40px auto;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #e35b2d;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        .total {
            text-align: right;
            font-weight: bold;
            margin-top: 20px;
            font-size: 1.2em;
        }
        .checkout-btn {
            display: block;
            margin: 30px auto 0;
            padding: 10px 30px;
            background-color: #e35b2d;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
        }
        button {
            cursor: pointer;
            padding: 4px 10px;
        }
    </style>
</head>
<body>

<header>
    <div class="header-left">
        <div class="logo">
            <a href="../index.html">
                <img src="chitietsanpham/img/logo/logo.png" alt="Logo NHN Sports">
            </a>
        </div>
        <div class="hotline">
            Hotline:
            <a href="tel:0123456789">0123456789</a> |
            <a href="tel:0123456789">0123456789</a>
        </div>
    </div>
    <div class="header-right">
        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Tìm kiếm sản phẩm...">
            <button type="submit">Tìm</button>
            <div id="search-results"></div>
        </div>
        <a href="dangnhap.html"><i class="fas fa-user"></i> Tài khoản</a>
        <a href="giohang.html"><i class="fas fa-shopping-cart"></i> Giỏ hàng</a>
    </div>
</header>

<nav>
    <div class="container">
        <ul class="menu">
            <li><a href="../index.html">TRANG CHỦ</a></li>
            <li><a href="sanpham.html">SẢN PHẨM</a></li>
            <li><a href="tintuc.html">TIN TỨC</a></li>
            <li><a href="chinhsachmuahang.html">CHÍNH SÁCH MUA HÀNG</a></li>
            <li><a href="huongdan.html">HƯỚNG DẪN</a></li>
            <li><a href="gioithieu.html">GIỚI THIỆU</a></li>
            <li><a href="hotro.html">LIÊN HỆ</a></li>
        </ul>
    </div>
</nav>

<main>
    <h1>Giỏ Hàng Của Bạn</h1>
    <table>
        <thead>
            <tr>
                <th>Sản phẩm</th>
                <th>Số lượng</th>
                <th>Đơn giá</th>
                <th>Thành tiền</th>
                <th>Xóa</th>
            </tr>
        </thead>
        <tbody id="cart-body">
            </tbody>
    </table>
    <div class="total" id="total-price">Tổng cộng: 0 ₫</div>
    <button class="checkout-btn">Thanh toán</button>
</main>
<script src="chitietsanpham/js/cart.js"></script>
<script>
    const cartBody = document.getElementById("cart-body");
    const totalPriceEl = document.getElementById("total-price");

    function formatCurrency(num) {
        return num.toLocaleString("vi-VN") + " ₫";
    }

    function renderCart() {
        const cartItems = getCartItems(); // Gọi hàm từ cart.js
        cartBody.innerHTML = "";
        let total = 0;

        if (cartItems.length === 0) {
            cartBody.innerHTML = '<tr><td colspan="5">Giỏ hàng trống</td></tr>';
        } else {
            cartItems.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;

                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>
                        <button onclick="decreaseQty(${item.id})">-</button>
                        <span style="margin: 0 8px;">${item.quantity}</span>
                        <button onclick="increaseQty(${item.id})">+</button>
                    </td>
                    <td>${formatCurrency(item.price)}</td>
                    <td>${formatCurrency(itemTotal)}</td>
                    <td><button onclick="removeItem(${item.id})" style="color:red;">X</button></td>
                `;
                cartBody.appendChild(row);
            });
        }

        totalPriceEl.textContent = `Tổng cộng: ${formatCurrency(total)}`;
    }

    function increaseQty(productId) {
        updateQuantity(productId, getCartItems().find(item => item.id === productId).quantity + 1); // Gọi hàm từ cart.js
        renderCart();
    }

    function decreaseQty(productId) {
        const currentItem = getCartItems().find(item => item.id === productId); // Gọi hàm từ cart.js
        if (currentItem && currentItem.quantity > 1) {
            updateQuantity(productId, currentItem.quantity - 1); // Gọi hàm từ cart.js
        } else if (currentItem && currentItem.quantity === 1) {
            removeFromCart(productId); // Gọi hàm từ cart.js
        }
        renderCart();
    }

    function removeItem(productId) {
        removeFromCart(productId); // Gọi hàm từ cart.js
        renderCart();
    }

    renderCart(); // Gọi renderCart khi trang được tải
</script>
</body>
</html>